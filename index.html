<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 通过 jsDelivr 引用 -->
<link href="https://cdn.jsdelivr.net/npm/unifont-js@latest/dist/unifont.woff2" rel="preload" as="font">
<link rel="preload" href="./fonts/unifont.otf" as="font" type="font/otf" crossorigin>
    <title>Minecraft特殊符号</title>
    <style>
        :root {
            --mc-dark: #2d2d2d;
            --mc-border: #4a4a4a;
            --mc-green: #7AA75A;
            --mc-text: #FFFFFF;
            --mc-hover: #9C9C9C;
        }

        body {
            background-color: #393939;
            background-image: 
                linear-gradient(rgba(0, 0, 0, 0.3) 50%, transparent 50%),
                linear-gradient(90deg, rgba(0, 0, 0, 0.3) 50%, transparent 50%);
            background-size: 4px 4px;
            image-rendering: pixelated;
            color: var(--mc-text);
            margin: 0;
            padding: 20px;
        }

        h3{
            color: #4CAF50;
            text-shadow: 2px 2px #000;
        }

        a{margin: 0 5px;}

        .serchboxcontainer{
            display: flex;
            width: 804px;
            margin: 16px auto;
            padding: 4px;
                border-image-source: url("./images/container.png");
        border-image-slice: 4 4 4 4 fill;
        border-width: 8px 8px 8px 8px;
        border-style: solid;
        image-rendering: pixelated;
            
        }

        #searchBox {
            display: block;
            width: 400px;
            margin: 20px 20px;
            padding: 10px;
            background: #8b8b8b;
            border: 2px solid;
            border-color: #373737 #fff #fff #373737;
            color: var(--mc-text);
            font-size: 16px;
            image-rendering: pixelated;
            transition: all 0.2s;
            margin-left: auto;
        }

        #searchBox:focus {
            outline: none;
        }

        .library-container {
            width: 804px;
            margin: 16px auto;
            padding: 4px;
                border-image-source: url("./images/container.png");
        border-image-slice: 4 4 4 4 fill;
        border-width: 8px 8px 8px 8px;
        border-style: solid;
        image-rendering: pixelated;
        }

        .glyph-container {
            display: grid;
            grid-template-columns: repeat(16, 50px);
            gap: 0;
            margin: 1px;
            border: 0px solid #181818;
        }

        .glyph-item {
            width: 46px;
            height: 46px;
            background: #8b8b8b;
            border: 2px solid;
            border-color: #373737 #fff #fff #373737;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
        }

        .glyph-item:hover {
            background: var(--mc-hover);
            border-color: #fff;
            background-color: #6aad43;
        }

        .glyph-preview {
            image-rendering: pixelated;
            width: 32px;
            height: 32px;
        }

        .tooltip {
            z-index: 9999; 
            position: fixed; /* 改为fixed定位 */
    pointer-events: none; /* 防止工具提示干扰 */
    border-image-source: url("./images/tooltip.png");
        border-image-slice: 4 4 4 4 fill;
        border-width: 8px 8px 8px 8px;
        border-style: solid;
        image-rendering: pixelated;
            padding: 6px 8px;
            font-size: 16px;
            white-space: nowrap;
            text-shadow: 2px 2px #000;
            display: none;
        }

        .glyph-item:hover .tooltip {
            display: block;
        }

        h2 {
            text-align: center;
            font-size: 24px;
            margin: 24px 0;
            color: var(--mc-green);
            text-shadow: 2px 2px #000;
        }

        #notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--mc-green);
            color: #fff;
            padding: 8px 16px;
            border: 2px solid #000;
            font-size: 16px;
            display: none;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
        }
        /* 现代浏览器优先使用 woff2 */
        @font-face {
  font-family: 'MyFont';
  src: 
    url('https://cdn.jsdelivr.net/npm/unifont-js@latest/dist/unifont.woff2') format('woff2'), /* 现代浏览器优先 */
    url('./fonts/unifont.otf') format('opentype'); /* 兼容备用 */
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

/* 应用字体 */
body {
  font-family: 'Unifont', monospace;
}

    </style>
</head>
<body>
    
    
    <div class="serchboxcontainer">
        <h2 style="text-align: center; color: #4CAF50;">Minecraft特殊符号</h2>
        <input type="text" id="searchBox" placeholder="输入文字搜索符号">
    </div>
    <div id="librariesContainer"></div>
    <div id="notification">已复制到剪贴板！</div>
    <div class="serchboxcontainer">
        <a href="https://github.com/Cyaniuu/glyph" class="me">Cyaniuu</a>
        <a href="./res/VanillaItemfontpack.mcpack" class="download">下载资源包</a>

    </div>
    
<script>
    
const LIBRARIES = [
    {
        title: "F0",
        unicodeStart: 0xF000,
        gridSize: 16,
        imagePath: "./server-glyphs/glyph_F0.png",
        specialTexts: {0: "合金欢门下部分",1: "合金欢门上部分",2: "和金欢树叶",3: "合金欢原木侧面",4: "合金欢原木上面",5: "合金欢木板",6: "合金欢树苗",7: "合金欢活版门",8: "激活铁轨",9: "已激活的激活铁轨",10: "绒球葱",11: "紫水晶块",12: "紫水晶簇",13: "远古残骸",14: "远古残骸上面",15: "安山岩",16: "",17: "",18: "垂滴叶根部",19: "垂滴叶尖",20: "垂滴叶",21: "白桦木门下部分",22: "白桦木门上部分",23: "白桦树叶",24: "白桦树原木",25: "白桦树原木上面",26: "白桦木板",27: "白桦树苗",28: "白桦木活版门",29: "黑石",30: "黑石",31: "",32: "气泡珊瑚扇",33: "紫水晶母岩",34: "仙人掌下面",35: "仙人掌侧面",36: "仙人掌上面",37: "蛋糕下面",38: "蛋糕被吃了的面",39: "蛋糕侧面",40: "蛋糕上面",41: "方解石",42: "篝火火焰",43: "篝火",44: "篝火",45: "蜡烛",46: "蜡烛",47: "",48: "命令方块",49: "命令方块",50: "命令方块",51: "红石比较器",52: "已激活的红石比较器",53: "堆肥桶下面",54: "堆肥桶内部",55: "堆肥桶内部有肥",56: "堆肥桶侧面",57: "堆肥桶上面",58: "",59: "铜块",60: "铜矿石",61: "矢车菊",62: "裂纹深板岩砖",63: "裂纹深板岩瓦",64: "失活珊瑚",65: "失活珊瑚",66: "失活珊瑚",67: "枯萎的灌木",68: "失活珊瑚",69: "失活珊瑚",70: "失活珊瑚",71: "失活珊瑚",72: "失活珊瑚",73: "失活珊瑚",74: "失活珊瑚",75: "失活珊瑚",76: "失活珊瑚",77: "",78: "",79: "深板岩",80: "末地石砖",81: "斑驳的铜块",82: "斑驳的切制铜块",83: "耕地",84: "湿润的耕地",85: "蕨",86: "火焰",87: "火焰",88: "火珊瑚",89: "火珊瑚块",90: "火珊瑚扇",91: "制箭台前面",92: "制箭台侧面",93: "制箭台上面",94: "杜鹃花树叶",95: "杜鹃花树苗",96: "",97: "",98: "干草块侧面",99: "干草块上面",100: "蜜脾块",101: "蜜块外层",102: "蜜块",103: "蜜块",104: "炼药锅下面",105: "炼药锅侧面",106: "炼药锅上面",107: "鹿角珊瑚",108: "鹿角珊瑚块",109: "鹿角珊瑚扇",110: "冰",111: "铁栏杆",112: "淡蓝色羊毛",113: "",114: "",115: "淡灰色混凝土",116: "淡灰色混凝土粉末",117: "淡灰色带釉陶瓦",118: "淡灰色潜影盒",119: "淡灰色玻璃",120: "淡灰色玻璃板",121: "淡灰色陶瓦",122: "淡灰色羊毛",123: "丁香花下部分",124: "丁香花上部分",125: "铃兰",126: "睡莲",127: "",128: "蘑菇块",129: "蘑菇柄",130: "菌丝体",131: "菌丝体上面",132: "合金块",133: "下届岩",134: "下届砖块",135: "下届金矿石",136: "地狱门",137: "石英矿石",}
    },
    {
        title: "F1",
        unicodeStart: 0xF100,
        gridSize: 16,
        imagePath: "./server-glyphs/glyph_F1.png",
        specialTexts: {255: ""}
    },
    {
        title: "F2",
        unicodeStart: 0xF200,
        gridSize: 16,
        imagePath: "./server-glyphs/glyph_F2.png",
        specialTexts: {0: "", 1: ""}
    },
    {
        title: "F3",
        unicodeStart: 0xF300,
        gridSize: 16,
        imagePath: "./server-glyphs/glyph_F3.png",
        specialTexts: {}
    },
    {
        title: "F4",
        unicodeStart: 0xF400,
        gridSize: 16,
        imagePath: "./server-glyphs/glyph_F4.png",
        specialTexts: {}
    },
    {
        title: "F5",
        unicodeStart: 0xF500,
        gridSize: 16,
        imagePath: "./server-glyphs/glyph_F5.png",
        specialTexts: {9: ""}
    },
    {
        title: "F6",
        unicodeStart: 0xF600,
        gridSize: 16,
        imagePath: "./server-glyphs/glyph_F6.png",
        specialTexts: {}
    },
    {
        title: "F7",
        unicodeStart: 0xF700,
        gridSize: 16,
        imagePath: "./server-glyphs/glyph_F7.png",
        specialTexts: {0: ""}
    }
];

let searchCache = [];
let searchTimeout = null;

function buildSearchCache() {
    searchCache = LIBRARIES.map(lib => ({
        title: lib.title.toLowerCase(),
        container: null,
        items: []
    }));
}

function initLibraries() {
    const container = document.getElementById('librariesContainer');
    buildSearchCache();
    
    LIBRARIES.forEach((lib, libIndex) => {
        const libContainer = document.createElement('div');
        libContainer.className = 'library-container';
        
        const title = document.createElement('h3');
        title.textContent = lib.title;
        libContainer.appendChild(title);

        const grid = document.createElement('div');
        grid.className = 'glyph-container';
        libContainer.appendChild(grid);
        
        container.appendChild(libContainer);
        initSingleLibrary(lib, grid, libIndex);
        
        searchCache[libIndex].container = libContainer;
    });
}

function initSingleLibrary(config, container, libIndex) {
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const img = new Image();

    img.crossOrigin = "Anonymous";
    img.onload = function() {
        canvas.width = img.width;
        canvas.height = img.height;
        ctx.drawImage(img, 0, 0);

        const cellSize = img.width / config.gridSize;
        const itemsData = [];
        
        for(let i = 0; i < config.gridSize ** 2; i++) {
            const col = i % config.gridSize;
            const row = Math.floor(i / config.gridSize);
            
            const item = document.createElement('div');
            item.className = 'glyph-item';
            
            const previewCanvas = document.createElement('canvas');
            previewCanvas.width = 16;
            previewCanvas.height = 16;
            const previewCtx = previewCanvas.getContext('2d');
            
            previewCtx.drawImage(
                canvas,
                col * cellSize,
                row * cellSize,
                cellSize,
                cellSize,
                0,
                0,
                16,
                16
            );

            const specialText = (config.specialTexts[i] || '').toLowerCase();
            itemsData.push({ node: item, text: specialText });
            
            const codePoint = config.unicodeStart + i;
            const char = String.fromCodePoint(codePoint);
            const tooltipContent = [
                specialText ? `${config.specialTexts[i]}` : '',
                `位置：(${col + 1}, ${row + 1})`,
                `Unicode：U+${codePoint.toString(16).toUpperCase()}`
            ].filter(Boolean).join('<br>');

            item.innerHTML = `
    <img class="glyph-preview" src="${previewCanvas.toDataURL()}">
    <div class="tooltip">${tooltipContent}</div>
`;


// 新增鼠标事件监听
const tooltip = item.querySelector('.tooltip');

item.addEventListener('mouseenter', () => {
    tooltip.style.display = 'block';
});

item.addEventListener('mousemove', (e) => {
    // 设置跟随偏移（向右下偏移20px）
    tooltip.style.left = e.clientX + 20 + 'px';
tooltip.style.top = e.clientY + -20 + 'px';
    // 在mousemove事件中添加边界检测
const winWidth = window.innerWidth;
const winHeight = window.innerHeight;
const tooltipWidth = tooltip.offsetWidth;

if (e.pageX + tooltipWidth + 20 > winWidth) {
    tooltip.style.left = e.pageX - tooltipWidth - 20 + 'px';
} else {
    tooltip.style.left = e.pageX + 20 + 'px';
}
});

item.addEventListener('mouseleave', () => {
    tooltip.style.display = 'none';
});

let activeTooltip = null;

item.addEventListener('mouseenter', (e) => {
    if (activeTooltip) activeTooltip.style.display = 'none';
    activeTooltip = tooltip;
    tooltip.style.display = 'block';
});

item.addEventListener('mouseleave', () => {
    activeTooltip = null;
    tooltip.style.display = 'none';
});



            item.addEventListener('click', () => handleCopy(char));
            container.appendChild(item);
        }
        
        searchCache[libIndex].items = itemsData;
    };
    img.src = config.imagePath;
}

function handleCopy(char) {
    const tempInput = document.createElement('textarea');
    tempInput.value = char;
    document.body.appendChild(tempInput);
    
    if (navigator.userAgent.match(/iphone|ipod|ipad/i)) {
        const range = document.createRange();
        range.selectNodeContents(tempInput);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        tempInput.setSelectionRange(0, 999999);
    } else {
        tempInput.select();
    }
    
    try {
        document.execCommand('copy');
        showNotification();
    } catch (err) {
        console.error('复制失败:', err);
    }
    
    document.body.removeChild(tempInput);
}

function showNotification() {
    const notification = document.getElementById('notification');
    notification.style.display = 'block';
    setTimeout(() => {
        notification.style.display = 'none';
    }, 2000);
}

function handleSearch() {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(performSearch, 300);
}

function performSearch() {
    const searchTerm = document.getElementById('searchBox').value.trim().toLowerCase();
    
    searchCache.forEach((lib, libIndex) => {
        const { title, container, items } = lib;
        let hasVisible = false;
        
        if (title.includes(searchTerm)) {
            container.style.display = 'block';
            items.forEach(item => item.node.style.display = 'flex');
            return;
        }
        
        let anyVisible = false;
        items.forEach(item => {
            const isMatch = item.text.includes(searchTerm);
            item.node.style.display = isMatch ? 'flex' : 'none';
            if (isMatch) anyVisible = true;
        });
        
        container.style.display = anyVisible ? 'block' : 'none';
    });
}

document.getElementById('searchBox').addEventListener('input', handleSearch);

window.addEventListener('DOMContentLoaded', () => {
    initLibraries();
    document.getElementById('notification').style.display = 'none';
});
</script>
</body>
</html>
